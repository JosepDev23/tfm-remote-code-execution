<div 
  class="vscode-container" 
  (dragover)="onDragOver($event)" 
  (dragleave)="onDragLeave($event)" 
  (drop)="onDrop($event)"
  [class.dragging]="isDragging">
  
  <!-- Drag and Drop Overlay -->
  @if (isDragging) {
    <div class="drop-overlay">
      <div class="drop-message">
        <span class="drop-icon">üìÅ</span>
        <h2>Drop {{ languageName }} files here</h2>
        <p>Files will be imported into the editor</p>
      </div>
    </div>
  }
  <!-- Activity Bar (Left Sidebar Icons) -->
  <aside class="activity-bar">
    <div class="activity-item active" title="Explorer">
      <span class="activity-icon">üìÅ</span>
    </div>
    <div class="activity-item" (click)="goBack()" title="Back to Home">
      <span class="activity-icon">üè†</span>
    </div>
  </aside>

  <!-- Sidebar (File Explorer) -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <span class="sidebar-title">EXPLORER</span>
    </div>
    <div class="sidebar-content">
      <div class="folder-section">
        <div class="folder-header">
          <span class="folder-icon">‚ñº</span>
          <span class="folder-name">{{ languageName.toUpperCase() }} PROJECT</span>
          <button class="folder-action-btn" (click)="createFile()" title="New File">
            <span>+</span>
          </button>
        </div>
        <div class="file-list">
          @for (file of files; track file.id) {
            <div class="file-item" [class.active]="file.id === activeFileId" (click)="switchFile(file.id)">
              <span class="file-icon">üìÑ</span>
              @if (renamingFileId === file.id) {
                <input 
                  class="file-rename-input"
                  type="text"
                  [value]="file.name"
                  (blur)="finishRenaming(file.id, $any($event.target).value)"
                  (keydown)="finishRenaming(file.id, $any($event.target).value, $event)"
                  (click)="$event.stopPropagation()"
                />
              } @else {
                <span class="file-name" (dblclick)="startRenaming(file.id, $event)">{{ file.name }}</span>
              }
              @if (files.length > 1) {
                <button class="file-delete-btn" (click)="deleteFile(file.id); $event.stopPropagation()" title="Delete File">
                  <span>√ó</span>
                </button>
              }
            </div>
          }
        </div>
      </div>
    </div>
  </aside>

  <!-- Main Editor Area -->
  <main class="main-editor">
    <!-- Tab Bar -->
    <div class="tab-bar">
      <div class="tab active">
        <span class="tab-icon">üìÑ</span>
        <span class="tab-label">{{ getActiveFile()?.name || 'Untitled' }}</span>
      </div>
      <div class="tab-actions">
        <button 
          class="tab-action-btn run-btn" 
          (click)="executeCode()"
          [disabled]="isExecuting"
          [class.executing]="isExecuting"
          title="Run Code">
          <span>{{ isExecuting ? '‚è∏' : '‚ñ∂' }}</span>
        </button>
        <button 
          class="tab-action-btn download-btn" 
          (click)="downloadFile()"
          title="Download File">
          <span>‚¨á</span>
        </button>
        <button 
          class="tab-action-btn" 
          (click)="deleteContainer()"
          title="Delete Container">
          <span>üóë</span>
        </button>
      </div>
    </div>

    <!-- Editor Content -->
    <div class="editor-content">
      <div class="editor-area">
        <div class="line-numbers">
          @for (line of getLineNumbers(); track $index) {
            <div class="line-number">{{ line }}</div>
          }
        </div>
        <textarea 
          class="code-editor"
          [ngModel]="getActiveFile()?.content" 
          (ngModelChange)="getActiveFile() && (getActiveFile()!.content = $event)"
          spellcheck="false"
          placeholder="Start coding..."
          (input)="onCodeChange()"
          (scroll)="onEditorScroll($event)">
        </textarea>
      </div>
    </div>

    <!-- Panel Resize Handle -->
    <div class="panel-resize-handle" (mousedown)="startResize($event)"></div>

    <!-- Panel (Terminal/Output) -->
    <div class="panel-container" [style.height.px]="panelHeight">
      <div class="panel-tabs">
        <div class="panel-tab active">
          <span class="panel-tab-icon">üíª</span>
          <span>OUTPUT</span>
        </div>
        <div class="panel-tab">
          <span class="panel-tab-icon">‚ö†</span>
          <span>PROBLEMS</span>
        </div>
        <div class="panel-actions">
          <button class="panel-action-btn" (click)="clearOutput()" title="Clear Output">
            <span>‚úï</span>
          </button>
        </div>
      </div>
      <div class="panel-content">
        @if (isExecuting) {
          <div class="output-loading">
            <div class="loading-spinner"></div>
            <span>Executing code...</span>
          </div>
        }
        <pre class="output-display" [class.empty]="!output || output.includes('Output will be displayed')">{{ output }}</pre>
      </div>
    </div>
  </main>

  <!-- Status Bar -->
  <footer class="status-bar">
    <div class="status-left">
      <span class="status-item branch">
        <span class="status-icon">‚éá</span>
        <span>main</span>
      </span>
      <span class="status-item" [class.executing]="isExecuting">
        <span class="status-dot">‚óè</span>
        <span>{{ isExecuting ? 'Running' : 'Ready' }}</span>
      </span>
    </div>
    <div class="status-right">
      <span class="status-item">Ln {{ getCurrentLine() }}, Col {{ getCurrentColumn() }}</span>
      <span class="status-item">UTF-8</span>
      <span class="status-item">{{ languageName }}</span>
    </div>
  </footer>
</div>
